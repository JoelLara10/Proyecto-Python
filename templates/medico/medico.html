<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Módulo Médico - INEO</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/e547be4475.js" crossorigin="anonymous"></script>

    <style>
        body { background-color: #f4f6f9; }
        .navbar { background-color: #1e3c72; }
        .navbar-brand, .navbar-text { color: #fff !important; }
        .icon-circle { width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; }
        .bed-card { border-radius: 12px; min-height: 130px; transition: all .3s; text-align: center; font-size: .95rem; }
        .bed-card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,.15); }
        .bed-free { background: #e9ecef; color: #495057; }
        .bed-occupied { background: #bfdbfe; color: #1e40af; }
        .section-title { color: #1e3c72; font-weight: 700; margin: 2rem 0 1rem; }
    </style>
</head>
<body>

<!-- NAVBAR SUPERIOR -->
<nav class="navbar navbar-expand-lg shadow">
  <div class="container-fluid">

    <!-- BOTÓN REGRESAR -->
    <a href="{{ url_for('dashboard') }}" class="btn btn-outline-light btn-sm me-3">
      <i class="bi bi-arrow-left"></i> Regresar
    </a>

    <div class="ms-auto">
      <span class="navbar-text me-3">
        <i class="bi bi-person-circle"></i>
        {{ session['username'] }}
      </span>

      <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm">
        <i class="bi bi-box-arrow-right"></i> Cerrar sesión
      </a>
    </div>
  </div>
</nav>

<div class="container-fluid mt-4">
    <div class="row">
        <!-- SIDEBAR (opcional, puedes mantener tu menú aquí) -->
        <div class="col-md-3 collapse" id="sidebar">
            <!-- Tu menú lateral aquí si lo deseas -->
        </div>

        <!-- CONTENIDO -->
        <div class="col-md-12">
            <h4 class="section-title">MÉDICO</h4>

            <!-- Botones rápidos (solo si tiene permiso) -->
            {% if session['role'] == 'admin' or True %}   <!-- ajusta si quieres filtro -->
            <div class="row g-3 mb-4">
                <div class="col-md-4">
                    <a href="#" class="text-decoration-none">
                        <div class="card shadow-sm text-center p-4">
                            <div class="icon-circle" style="background: linear-gradient(45deg,#007bff,#00c4ff);">
                                <i class="bi bi-calendar-event fs-2 text-white"></i>
                            </div>
                            <h5>Agenda Quirúrgica</h5>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="#" class="text-decoration-none">
                        <div class="card shadow-sm text-center p-4">
                            <div class="icon-circle" style="background: linear-gradient(45deg,#28a745,#34c759);">
                                <i class="bi bi-calendar-event fs-2 text-white"></i>
                            </div>
                            <h5>Agenda Consulta Externa</h5>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="#" class="text-decoration-none">
                        <div class="card shadow-sm text-center p-4">
                            <div class="icon-circle" style="background: linear-gradient(45deg,#6c757d,#adb5bd);">
                                <i class="bi bi-people-fill fs-2 text-white"></i>
                            </div>
                            <h5>Pacientes Atendidos</h5>
                        </div>
                    </a>
                </div>
            </div>
            {% endif %}

            <!-- CONSULTA EXTERNA -->
            <h5 class="section-title">PACIENTES EN CONSULTA EXTERNA</h5>
            <div class="row g-3">
                {% for bed in beds_consulta %}
                {% set link = '#' %}
                {% if bed.id_atencion %}
    {% set link = '/medico/paciente/' ~ bed.id_atencion ~ '/' ~ bed.Id_exp %}
{% endif %}

                <div class="col-6 col-sm-4 col-md-3 col-lg-2">
                    <a href="{{ link }}" class="text-decoration-none">
                        <div class="card bed-card shadow-sm bed-occupied">
                            <strong>{{ bed.num_cama }}</strong><br>
                            <small>{{ bed.papell }} {{ bed.nom_pac }}</small>
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>

            <!-- PREPARACIÓN (Urgencias) -->
            <h5 class="section-title">PACIENTES EN PREPARACIÓN</h5>
            <div class="row g-3">
                {% for bed in beds_preparacion %}
                {% set cls = 'bed-free' if bed.estatus == 'LIBRE' else 'bed-occupied' %}
                {% set link = '#' %}
                {% if bed.id_atencion %}
    {% set link = '/medico/paciente/' ~ bed.id_atencion ~ '/' ~ bed.Id_exp %}
{% endif %}

                <div class="col-6 col-sm-4 col-md-3 col-lg-2">
                    <a href="{{ link }}" class="text-decoration-none">
                        <div class="card bed-card shadow-sm {{ cls }}">
                            <strong>Cama {{ bed.num_cama }}</strong><br>
                            {% if bed.estatus == 'OCUPADA' %}
                                <small>{{ bed.papell }} {{ bed.nom_pac }}</small>
                            {% else %}
                                <small>LIBRE</small>
                            {% endif %}
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>

            <!-- RECUPERACIÓN (Hospitalizado) -->
            <h5 class="section-title">PACIENTES EN RECUPERACIÓN</h5>
            <div class="row g-3">
                {% for bed in beds_recuperacion %}
                {% set cls = 'bed-free' if bed.estatus == 'LIBRE' else 'bed-occupied' %}
                {% set link = '#' %}
                {% if bed.id_atencion %}
    {% set link = '/medico/paciente/' ~ bed.id_atencion ~ '/' ~ bed.Id_exp %}
{% endif %}

                <div class="col-6 col-sm-4 col-md-3 col-lg-2">
                    <a href="{{ link }}" class="text-decoration-none">
                        <div class="card bed-card shadow-sm {{ cls }}">
                            <strong>Cama {{ bed.num_cama }}</strong><br>
                            {% if bed.estatus == 'OCUPADA' %}
                                <small>{{ bed.papell }} {{ bed.nom_pac }}</small>
                            {% else %}
                                <small>LIBRE</small>
                            {% endif %}
                        </div>
                    </a>
                </div>
                {% endfor %}
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>